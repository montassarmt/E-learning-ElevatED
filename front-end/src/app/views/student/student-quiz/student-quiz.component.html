<div class="card border mb-5">
 <!-- Quiz Selection Screen -->
 <div *ngIf="!quizStarted && !quizCompleted" class="card-body">
   <div class="card-header border-bottom">
     <h3 class="mb-0">Available Quizzes</h3>
   </div>
   <div class="card-body">
     <div *ngIf="quizzes.length === 0" class="alert alert-info">
       No quizzes available at the moment.
     </div>
     <div class="vstack gap-2">
       <div *ngFor="let quiz of quizzes" class="card bg-transparent border rounded-3">
         <div class="card-body d-flex justify-content-between align-items-center">
           <h5 class="card-title mb-0">{{ quiz.title }}</h5>
           <button class="btn btn-primary" (click)="startQuiz(quiz)">
             Start Quiz ({{ quiz.duration }} mins)
           </button>
         </div>
       </div>
     </div>
   </div>
 </div>

 <!-- Quiz Taking Screen -->
 <div *ngIf="quizStarted && !quizCompleted && selectedQuiz" class="card-body">
   <div class="card bg-transparent border rounded-3 mb-1">
     <div class="card-header bg-light border-bottom px-lg-5">
       <!-- Stepper Header -->
       <div class="bs-stepper-header" role="tablist">
         <ng-container *ngFor="let question of selectedQuiz.questions; let i = index; let last = last">
           <div
             class="step"
             [ngClass]="{ active: i === currentStep }"
             [attr.data-target]="'#step-' + i"
           >
             <div class="d-grid text-center align-items-center">
               <button
                 type="button"
                 class="btn btn-link step-trigger mb-0"
                 (click)="currentStep = i"
                 [disabled]="quizCompleted"
                 [attr.aria-label]="'Go to question ' + (i + 1)"
               >
                 <span class="bs-stepper-circle">{{ i + 1 }}</span>
               </button>
             </div>
           </div>
           <!-- Render line only if not the last step -->
           <div *ngIf="!last" class="line"></div>
         </ng-container>
       </div>
     </div>

     <div class="card-body">
       <!-- Timer -->
       <h6 class="text-danger text-end mb-0">
         <i class="bi bi-clock-history me-2"></i>Time Left: {{ formatTime(timeRemaining) }}
       </h6>

       <!-- Stepper Content -->
       <div class="bs-stepper-content">
         <form>
           <div
             *ngIf="selectedQuiz.questions[currentStep] as question"
             role="tabpanel"
             class="content fade show active"
           >
             <h4>{{ question.text }}</h4>
             <hr />
             <div class="vstack gap-2">
               <div *ngFor="let answer of question.answers; let j = index">
                 <input
                   type="radio"
                   class="btn-check"
                   [name]="'ques-' + question.id"
                   [id]="'option-' + question.id + '-' + j"
                   [value]="answer.id"
                   (change)="selectAnswer(question.id, answer.id)"
                   [checked]="selectedAnswers[question.id] === answer.id"
                   [attr.aria-label]="answer.text"
                 />
                 <label
                   class="btn btn-outline-primary w-100"
                   [for]="'option-' + question.id + '-' + j"
                 >
                   {{ answer.text }}
                 </label>
               </div>
             </div>

             <div class="d-flex justify-content-center mt-3 gap-2">
               <button
                 type="button"
                 class="btn btn-secondary"
                 (click)="previousStep()"
                 [disabled]="currentStep === 0"
               >
                 Previous
               </button>
               <button
                 *ngIf="currentStep < selectedQuiz.questions.length - 1"
                 type="button"
                 class="btn btn-primary"
                 (click)="nextStep()"
               >
                 Next Question
               </button>
               <button
                 *ngIf="currentStep === selectedQuiz.questions.length - 1"
                 type="button"
                 class="btn btn-success"
                 (click)="submitQuiz()"
               >
                 View Result
               </button>
             </div>
           </div>
         </form>
       </div>
     </div>
   </div>
 </div>

 <!-- Quiz Results Screen -->
 <div *ngIf="quizCompleted && quizResult" class="card-body">
   <div class="card bg-transparent border rounded-3">
     <div
       class="card-header"
       [ngClass]="{
         'bg-success': quizResult.passed,
         'bg-danger': !quizResult.passed
       }"
     >
       <h3 class="text-white">Quiz Results</h3>
     </div>
     <div class="card-body text-center">
       <h4>{{ quizResult.passed ? 'Congratulations!' : 'Try Again' }}</h4>
       <div class="display-4">
         {{ quizResult.score }} / {{ quizResult.totalQuestions }}
       </div>
       <p class="lead">
         {{ quizResult.passed ? 'You passed the quiz!' : 'You need more practice.' }}
       </p>
       <div class="row mt-4">
         <div class="col-md-6 offset-md-3">
           <div class="card mb-3">
             <div class="card-header bg-light">
               <h5 class="mb-0">Summary</h5>
             </div>
             <div class="card-body">
               <ul class="list-group list-group-flush">
                 <li class="list-group-item d-flex justify-content-between">
                   <span>Score:</span>
                   <span>{{ quizResult.score }}</span>
                 </li>
                 <li class="list-group-item d-flex justify-content-between">
                   <span>Total Questions:</span>
                   <span>{{ quizResult.totalQuestions }}</span>
                 </li>
                 <li class="list-group-item d-flex justify-content-between">
                   <span>Percentage:</span>
                   <span>{{ (quizResult.score / quizResult.totalQuestions * 100).toFixed(1) }}%</span>
                 </li>
                 <li class="list-group-item d-flex justify-content-between">
                   <span>Time Taken:</span>
                   <span>{{ formatTime(quizResult.timeTaken) }}</span>
                 </li>
               </ul>
             </div>
           </div>
           <div class="d-grid gap-2">
             <button class="btn btn-primary" (click)="backToQuizzes()">
               Take Another Quiz
             </button>
             
           </div>
         </div>
       </div>
     </div>
   </div>
 </div>
</div>